name: shacl validation

on:
  push:
    branches:
    - develop_shapes
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
      with:
        path: main
    - name: Run reasoner
      run: |
           curl -L -o robot.jar "https://github.com/ontodev/robot/releases/latest/download/robot.jar"
           java -jar robot.jar reason --reasoner elk --input main/ontology.ttl --output out_ontology-reasoned.ttl
    - name: Validate against SHACL shapes
      run: |
           pip install pyshacl
           python3 -m pyshacl -f turtle -o ./out_shacl_report.ttl -s main/shapes.ttl out_ontology-reasoned.ttl
    - name: Keep report as artifact
      if: ${{ failure() }}
      uses: actions/upload-artifact@v3
      with:
        name: report
        path: ./out_*
